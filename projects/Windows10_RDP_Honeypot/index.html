<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Windows 10 Azure RDP Honeypot | ./Alexander </title> <meta name="author" content="./Alexander "> <meta name="description" content="Creating a Windows 10 machine on the Microsoft Azure Cloud and open the RDP Port to the internet to allow attackers to attempt to brute force the login."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website, cybersecurity, git, github, linux"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%9B%A1%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://assdcii.github.io/projects/Windows10_RDP_Honeypot/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">./Alexander</span> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Windows 10 Azure RDP Honeypot</h1> <p class="post-description">Creating a Windows 10 machine on the Microsoft Azure Cloud and open the RDP Port to the internet to allow attackers to attempt to brute force the login.</p> </header> <article> <h1 id="summary">Summary</h1> <p>I’ve experimented with the cloud before (mainly Amazon AWS) and I wanted to branch out into Microsofts cloud platform Microsoft Azure, but to see real world attacks on infrastructre that I control.</p> <p>In this project I was able to create a log and analytics platform within azure that enabled the collection of various data types but for this projet it was Windows Security logs on the Windows 10 platform.</p> <p>I was able to view brute force attacks in real time and watch how people from various places in the world tried to guess my password for an account that doesnt even have RDP rights within the computer.</p> <p>In total, there where <code class="language-plaintext highlighter-rouge">158,966</code> attemps made to get into the Windows 10 Machine over a <code class="language-plaintext highlighter-rouge">10 day</code> period <code class="language-plaintext highlighter-rouge">29/01/2025 - 07/02/2025</code> from about <code class="language-plaintext highlighter-rouge">30 different contries</code>.</p> <h1 id="definitions">Definitions</h1> <ul> <li>Brute Force <ul> <li>The act of attempting multiple times to guess a correct cridentials to gain <code class="language-plaintext highlighter-rouge">unauthorised or unintended access</code> into a system.</li> </ul> </li> <li>IDS <ul> <li>Stands for <code class="language-plaintext highlighter-rouge">Intrution Detection System</code> and is a technology used to typicaly scan network traffic and compair it to a set of rules to determine if there is any suspicous or harmful network activity.</li> </ul> </li> <li>IP <ul> <li>Stands for <code class="language-plaintext highlighter-rouge">Internet Protocol</code>. This is the backbone of the mondern internet and is the thing that allows for communication between networks. A IP Address will have 4 Octects and can range from 0-255. Example: 192.168.0.150, 5.254.33.111, 245.77.83.2</li> </ul> </li> <li>RDP <ul> <li>Stands for <code class="language-plaintext highlighter-rouge">Remote Desktop Protocol</code> and is the protocol that allows a user who is not physicaly infront of the machine to sign into that windows computer. Its like having the computer monitor anywhere, you just have to sign in.</li> </ul> </li> </ul> <h1 id="expected-results--method">Expected results &amp; method</h1> <h1 id="results">Results</h1> <p>div class=”row”&gt; &lt;div class="col-sm mt-3 mt-md-0"&gt;</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Top10-480.webp 480w,/assets/img/Top10-800.webp 800w,/assets/img/Top10-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Top10.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Top 10 IP's" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/div&gt;
&lt;div class="col-sm mt-3 mt-md-0"&gt;
</code></pre></div></div> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/top20-480.webp 480w,/assets/img/top20-800.webp 800w,/assets/img/top20-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/top20.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Top 20 Users" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/div&gt;
</code></pre></div></div> <p>&lt;/div&gt;</p> <div class="caption"> On the left is the `10 IP addresses` that sent out the most login attempts and the right image is the `20 most common users` that where guessed. </div> <p>Here on the left is just a nice visuilasation on what IP addresses are attacking the machine. We can see that <code class="language-plaintext highlighter-rouge">185.7.214.81</code> was very dedicated to trying to get into the machine. But in the later graphs we will see that this IP address in particular was going sort of “All or nothing” and sent in thousands of attempts in a short time frame then was never to be seen again.</p> <p>Although I didnt have any account restrictions or timeouts activated on the machine, but it seems like in a order to avoid or mask the fact that they are trying to brute force their way in, they throuttle their pace.</p> <p>Im thinking there are 2 possible reasons - They are attacking multiple machines and have <code class="language-plaintext highlighter-rouge">limmited bandwidth</code> - <code class="language-plaintext highlighter-rouge">Avoiding detection</code> either from any <code class="language-plaintext highlighter-rouge">Windows firewall, account, network policies</code> etc. or from a <code class="language-plaintext highlighter-rouge">IDS</code></p> <p>Next image is the Top 20 users that where attacked.</p> <p>This is in-line with the predicted guess as when you first create a Windows Server machine the default configuration will have the Administrator account active. Although it is good practice to not only <code class="language-plaintext highlighter-rouge">disable the Administrator account</code> but to also <code class="language-plaintext highlighter-rouge">restrict it</code> from even having the <code class="language-plaintext highlighter-rouge">ability to remotely connect</code> but im guessing this isnt as common as i’d like it to be. . .</p> <p>What im most intrested about is the <code class="language-plaintext highlighter-rouge">domain\</code> usage and the mispelt ADMINISTRATOR spelt <code class="language-plaintext highlighter-rouge">"ADMINISTRATEUR"</code> - I want to test if using the <code class="language-plaintext highlighter-rouge">domain\&lt;USER&gt;</code> will allow you to connect to a domain you dont know. For example if I had a domain called <code class="language-plaintext highlighter-rouge">Cherry</code> and I wanted to remotely login to a account of the <code class="language-plaintext highlighter-rouge">Cherry</code> domain, could I just type in <code class="language-plaintext highlighter-rouge">DOMAIN\ADMINISTRATOR</code> and get access to the domain administrator for Cherry?</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/wholeiprange-480.webp 480w,/assets/img/wholeiprange-800.webp 800w,/assets/img/wholeiprange-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/wholeiprange.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Vast IP Range" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Its kind of hard to guadge, but this graph tries to visualise how many IP addresses attempted to sign in. There where a total of `118 different IP addresses`. </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/inoneday-480.webp 480w,/assets/img/inoneday-800.webp 800w,/assets/img/inoneday-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/inoneday.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Total attempts in one day" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> In the Azure console for Azure Sentinal, if I set the range to the period length we get to see the events generated and that the `30th` was the `most active day`. </div> <p>If you wanted to download the raw CSV data - (results-sorted.csv)[assets/csv/results-sorted.csv] - (duplicate-usernames.csv)[assets/csv/duplicate-usernames.csv]</p> <p>The <code class="language-plaintext highlighter-rouge">results-sorted.csv</code> contains the extracted data from Azure Logs and Workspace analytics and has the <code class="language-plaintext highlighter-rouge">time generated, account, account type, computer, activity, ip address and logon type</code>.</p> <p>The <code class="language-plaintext highlighter-rouge">duplicate-usernames.csv</code> has a <code class="language-plaintext highlighter-rouge">count</code> column that displays the ammount of times that particular username was attacked and the <code class="language-plaintext highlighter-rouge">account</code> column next to it.</p> <h3 id="ip-address-reputation--location">IP Address reputation &amp; location</h3> <p>Next I wanted to get the geographical data and other info from maybe their ISP. As I had over 100 IP addresses I decided to just write a script that uses the VirusTotal API to gather that info for me instead of manualy going onto their website and having to search them up by hand.</p> <p>The code is pretty simple:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">iteration-ip.txt</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">ip_file</span><span class="p">:</span>  <span class="c1"># Grab the IP addresses in the file
</span>    <span class="n">IPs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">IPs</span> <span class="o">=</span> <span class="n">ip_file</span><span class="p">.</span><span class="nf">read</span><span class="p">().</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>            <span class="c1"># Split each IP address by a newline character
</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">IPs</span><span class="p">)):</span>     <span class="c1"># loop
</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://www.virustotal.com/api/v3/ip_addresses/</span><span class="sh">"</span> <span class="o">+</span> <span class="n">IPs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>    <span class="c1"># URL for the needed API + the current IP
</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">accept</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">application/json</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">x-apikey</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">&lt;API-KEY&gt;</span><span class="sh">"</span>     <span class="c1"># Add in your API key
</span>    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>       <span class="c1"># Send the response
</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">IPs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="sh">"</span><span class="s"> Had a response code of </span><span class="sh">"</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>     <span class="c1"># feedback in terminal
</span>
    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>       <span class="c1"># Make sure the API doesnt block us for too many requests
</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">IPs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="sh">"</span><span class="s">.json</span><span class="sh">"</span>         <span class="c1"># If you want the json to be human readable, in vscode or codium
</span>                                        <span class="c1"># use the hotkey CTRL + SHIFT + I to format it
</span>    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">))</span>             <span class="c1"># save the output in a json file named with the IP
</span></code></pre></div></div> <p>Now if I ran that script I would start getting an output that looks like this:</p> <p>div class=”row”&gt; &lt;div class="col-sm mt-3 mt-md-0"&gt;</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/running-script-480.webp 480w,/assets/img/running-script-800.webp 800w,/assets/img/running-script-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/running-script.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Output of running script" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/div&gt;
&lt;div class="col-sm mt-3 mt-md-0"&gt;
</code></pre></div></div> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/post-script-480.webp 480w,/assets/img/post-script-800.webp 800w,/assets/img/post-script-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/post-script.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Results of Script" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/div&gt;
</code></pre></div></div> <p>&lt;/div&gt;</p> <div class="caption"> On the left is the script outputting feedback in the terminal telling us what VirusTotals API response was (200 means good) and the left is the output of the api response stored in the json file with the ip address attached to it. </div> <p>With this new data in json format I was able to generate a cool looking <code class="language-plaintext highlighter-rouge">interactive heatmap</code> of what contries all of these IPs belonged to.</p> <p>This heatmap proved to confirm another of my guesses at the start of this project, that it would mostly be <code class="language-plaintext highlighter-rouge">developed contries</code> that are spraying passwords everywhere trying to get lucky.</p> <iframe title="Map of IP locations" aria-label="Map" id="datawrapper-chart-dFe5i" src="https://datawrapper.dwcdn.net/dFe5i/1/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="416" data-external="1"> </iframe> <script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r=0;r<e.length;r++)if(e[r].contentWindow===a.source){var i=a.data["datawrapper-height"][t]+"px";e[r].style.height=i}}}))}();
</script> <h1 id="conclution--preventions">Conclution &amp; Preventions</h1> <h2 id="references">References</h2> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 ./Alexander . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: February 25, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>