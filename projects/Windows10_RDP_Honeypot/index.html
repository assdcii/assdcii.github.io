<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Windows 10 Azure RDP Honeypot | ./Alexander </title> <meta name="author" content="./Alexander "> <meta name="description" content="Creating a Windows 10 machine on the Microsoft Azure Cloud and open the RDP Port to the internet to allow attackers to attempt to brute force the login."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website, cybersecurity, git, github, linux"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%9B%A1%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://assdcii.github.io/projects/Windows10_RDP_Honeypot/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">./Alexander</span> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Windows 10 Azure RDP Honeypot</h1> <p class="post-description">Creating a Windows 10 machine on the Microsoft Azure Cloud and open the RDP Port to the internet to allow attackers to attempt to brute force the login.</p> </header> <article> <h1 id="summary">Summary</h1> <p>I’ve experimented with the cloud before (mainly Amazon AWS) and I wanted to branch out into Microsoft’s cloud platform. Microsoft Azure, but to see real-world attacks on infrastructure that I control.</p> <p>In this project, I was able to create a log and analytics platform within Azure that enabled the collection of various data types but for this project it was Windows Security logs on the Windows 10 platform.</p> <p>I was able to view brute force attacks in real-time and watch how people from various places in the world tried to guess my password for an account that doesn’t even have RDP rights within the computer.</p> <p>In total, there were <code class="language-plaintext highlighter-rouge">158,966</code> attempts made to get into the Windows 10 Machine over a 10-day period <code class="language-plaintext highlighter-rouge">29/01/2025 - 07/02/2025</code> from about <code class="language-plaintext highlighter-rouge">30 different countries</code>.</p> <h1 id="definitions">Definitions</h1> <ul> <li>Brute Force <ul> <li>The act of attempting multiple times to guess the correct credentials to gain <code class="language-plaintext highlighter-rouge">unauthorized or unintended access</code> into a system.</li> </ul> </li> <li>IP <ul> <li>Stands for <code class="language-plaintext highlighter-rouge">Internet Protocol</code>. This is the backbone of the modern internet and is the thing that allows for communication between networks. An IP Address will have 4 Octects and can range from 0-255. Example: <code class="language-plaintext highlighter-rouge">192.168.0.150 | 5.254.33.111 | 245.77.83.2</code> </li> </ul> </li> <li>RDP <ul> <li>Stands for <code class="language-plaintext highlighter-rouge">Remote Desktop Protocol</code> and is the protocol that allows a user who is not physically in front of the machine to sign into that Windows computer and instead allowing sign-in through the network or internet. It’s like having the computer monitor anywhere, you just have to sign in.</li> </ul> </li> <li>Azure Sentinal <ul> <li>Azure Sentinal is <code class="language-plaintext highlighter-rouge">Microsofts integrated cloud SEIM solution</code> and can intake logs from various workspaces, read them, and compare them to a set of rules to determine if there is any <code class="language-plaintext highlighter-rouge">suspicious activity</code>. People like <code class="language-plaintext highlighter-rouge">SOC Analysts are then able to log into the portal to look at </code>cases, ` <code class="language-plaintext highlighter-rouge">incidents, create new rules, playbooks, send in KQL queries to gather log information, threat management and configuration for the intake of </code> <code class="language-plaintext highlighter-rouge">logs, data connections and create automation rules.</code> </li> </ul> </li> </ul> <h1 id="method">Method</h1> <ul> <li>In my results, I want to find some of the top offenders and gather information on them and their habits <ul> <li>Attributes like Geo-location</li> <li>IP Reputation on public Blacklists</li> <li>What user was attacked the most</li> </ul> </li> </ul> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Windows-machine-480.webp 480w,/assets/img/Windows-machine-800.webp 800w,/assets/img/Windows-machine-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Windows-machine.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Windows 10 Config" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>First we need to create the Windows machine and configure it to have a uncommon and complex username and password and a public IP address.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/azureSentinal-480.webp 480w,/assets/img/azureSentinal-800.webp 800w,/assets/img/azureSentinal-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/azureSentinal.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Azure Sentinal" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Once the VM is up and running we can create the Sentinal solution, logs, and analytics workspace and link it up to the Windows VM using the Data Connecters function</p> <p>The data connectors function allows the Windows VM to send all of its logs to the Logs and Analytics workspace so Sentinal can read them.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/azuresentinal-480.webp 480w,/assets/img/azuresentinal-800.webp 800w,/assets/img/azuresentinal-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/azuresentinal.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Azure Sentinal" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>The Medium alert has the following KQL Query</p> <pre><code class="language-kql">//Checks in the security event logs and discards any logs that have the user "SYSTEM" 
//and looks for event code 4625 which is a failed login attempt
SecurityEvent
| where Account !has "SYSTEM" and EventID == "4625"
</code></pre> <p>The Successful login attempt rule has the same query but the EventID is “4624”.</p> <p>The query will run every 5 minutes and if there are matches then it will generate an incident. These incidents can have automated responses, playbooks, and other automated tasks assigned to it.</p> <h1 id="results">Results</h1> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Top10-480.webp 480w,/assets/img/Top10-800.webp 800w,/assets/img/Top10-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/Top10.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Top 10 IP's" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> This image is the `10 IP addresses` that sent out the most login attempts. </div> <p>Here on the left is just a nice visualization of what IP addresses are attacking the machine. We can see that <code class="language-plaintext highlighter-rouge">185.7.214.81</code> was very dedicated to trying to get into the machine. But in the later graphs, we will see that this IP address in particular was going sort of “All or nothing” and sent in thousands of attempts in a short time frame then was never to be seen again.</p> <p>Although I didn’t have any account restrictions or timeouts activated on the machine, it seems like to avoid or mask the fact that they are trying to brute force their way in, they throttle their pace.</p> <ul> <li>I think there are 2 possible reasons <ul> <li>They are attacking multiple machines and have <code class="language-plaintext highlighter-rouge">limited bandwidth</code> </li> <li> <code class="language-plaintext highlighter-rouge">Avoiding detection</code> either from any <code class="language-plaintext highlighter-rouge">Windows firewall, account, network policies</code>, etc., or from an <code class="language-plaintext highlighter-rouge">IDS</code> </li> </ul> </li> </ul> <div class="row justify-content-sm-center"> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/top20-480.webp 480w,/assets/img/top20-800.webp 800w,/assets/img/top20-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/top20.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Top 20 Users" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> This image is the `20 most common users` that where guessed. </div> <p>These are the most attacked accounts and they make sense. The default configuration on a Windows Server will have you create a password for the Administrator account and it’s unlikely that server administrators will want to change or disable the pre-made account as it’s the easier option. Although it is good practice to not only <code class="language-plaintext highlighter-rouge">disable the Administrator account</code> but to also <code class="language-plaintext highlighter-rouge">restrict it</code> from even having the <code class="language-plaintext highlighter-rouge">ability to remotely connect</code> but I’m guessing this isn’t as common as I’d like it to be. . .</p> <ul> <li>What I’m most interested in is the <code class="language-plaintext highlighter-rouge">domain\</code> keyword <ul> <li>I want to test if using the <code class="language-plaintext highlighter-rouge">domain\&lt;USER&gt;</code> will allow you to connect to a domain you don’t know. For example, if I had a domain called <code class="language-plaintext highlighter-rouge">Cherry</code> and I wanted to remotely log in to an account of the <code class="language-plaintext highlighter-rouge">Cherry</code> domain, could I just type in <code class="language-plaintext highlighter-rouge">DOMAIN\ADMINISTRATOR</code> and get access to the domain administrator for Cherry? Or will I have to know the domain to sign into that domain administrator (<code class="language-plaintext highlighter-rouge">CHERRY\ADMINISTRATOR</code>)?</li> </ul> </li> </ul> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/wholeiprange-480.webp 480w,/assets/img/wholeiprange-800.webp 800w,/assets/img/wholeiprange-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/wholeiprange.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Vast IP Range" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Its kind of hard to gauge, but this graph tries to visualize how many IP addresses attempted to sign in. There were a total of `118 different IP addresses`. </div> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/inoneday-480.webp 480w,/assets/img/inoneday-800.webp 800w,/assets/img/inoneday-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/inoneday.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Total attempts in one day" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> In the Azure console for Azure Sentinal, if I set the range to the period length we get to see the events generated and that the `30th` was the `most active day`. </div> <ul> <li>If you wanted to download the raw CSV data <ul> <li><a href="/assets/csv/results-sorted.csv">results-sorted.csv</a></li> <li><a href="/assets/csv/duplicate-usernames.csv">duplicate-usernames.csv</a></li> </ul> </li> </ul> <p>The <code class="language-plaintext highlighter-rouge">results-sorted.csv</code> contains the extracted data from Azure Logs and Workspace analytics and has the <code class="language-plaintext highlighter-rouge">time generated, account, account type, computer, activity, ip address, and logon type</code>.</p> <p>The <code class="language-plaintext highlighter-rouge">duplicate-usernames.csv</code> has a <code class="language-plaintext highlighter-rouge">count</code> column that displays the number of times that particular username was attacked and the <code class="language-plaintext highlighter-rouge">account</code> column next to it.</p> <h3 id="ip-address-reputation--location">IP Address reputation &amp; location</h3> <p>Next, I wanted to get the geographical data and other info from maybe their ISP. As I had over 100 IP addresses I decided to just write a script that uses the VirusTotal API to gather that info for me instead of manually going onto their website and having to search them by hand.</p> <p>The code is pretty simple:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">iteration-ip.txt</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">ip_file</span><span class="p">:</span>  <span class="c1"># Grab the IP addresses in the file
</span>    <span class="n">IPs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">IPs</span> <span class="o">=</span> <span class="n">ip_file</span><span class="p">.</span><span class="nf">read</span><span class="p">().</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>            <span class="c1"># Split each IP address by a newline character
</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">IPs</span><span class="p">)):</span>     <span class="c1"># loop
</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://www.virustotal.com/api/v3/ip_addresses/</span><span class="sh">"</span> <span class="o">+</span> <span class="n">IPs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>    <span class="c1"># URL for the needed API + the current IP
</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">accept</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">application/json</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">x-apikey</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">&lt;API-KEY&gt;</span><span class="sh">"</span>     <span class="c1"># Add in your API key
</span>    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>       <span class="c1"># Send the request
</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">IPs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="sh">"</span><span class="s"> Had a response code of </span><span class="sh">"</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>     <span class="c1"># feedback in terminal
</span>
    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>       <span class="c1"># Make sure the API doesnt block us for too many requests
</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">IPs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="sh">"</span><span class="s">.json</span><span class="sh">"</span>         <span class="c1"># If you want the json to be human readable, in vscode or codium
</span>                                        <span class="c1"># use the hotkey CTRL + SHIFT + I to format it
</span>    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">))</span>             <span class="c1"># save the output in a json file named with the IP
</span></code></pre></div></div> <p>Now if I ran that script I would start getting an output that looks like this:</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/running-script-480.webp 480w,/assets/img/running-script-800.webp 800w,/assets/img/running-script-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/running-script.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Output of running script" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> This is the script outputting feedback in the terminal telling us what VirusTotals API response was (200 means good). </div> <div class="row justify-content-sm-center"> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/post-script-480.webp 480w,/assets/img/post-script-800.webp 800w,/assets/img/post-script-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/post-script.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Results of Script" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> This is the output of the api response stored in the json file with the ip address attached to it. </div> <p>This is a sample of the JSON data I got from VirusTotal.</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"185.7.214.81"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ip_address"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.virustotal.com/api/v3/ip_addresses/185.7.214.81"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"last_https_certificate_date"</span><span class="p">:</span><span class="w"> </span><span class="mi">1637657634</span><span class="p">,</span><span class="w">
            </span><span class="nl">"asn"</span><span class="p">:</span><span class="w"> </span><span class="mi">207566</span><span class="p">,</span><span class="w">
            </span><span class="nl">"last_analysis_results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"Acronis"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"blacklist"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"engine_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Acronis"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"harmless"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"clean"</span><span class="w">
                </span><span class="p">},</span><span class="w">
</span><span class="err">//=====================</span><span class="w"> </span><span class="err">CUT</span><span class="w"> </span><span class="err">=====================\\</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"ZeroFox"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"blacklist"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"engine_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ZeroFox"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"undetected"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unrated"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"last_analysis_stats"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"malicious"</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w">
                </span><span class="nl">"suspicious"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="nl">"undetected"</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w">
                </span><span class="nl">"harmless"</span><span class="p">:</span><span class="w"> </span><span class="mi">55</span><span class="p">,</span><span class="w">
                </span><span class="nl">"timeout"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"as_owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chang Way Technologies Co. Limited"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"last_modification_date"</span><span class="p">:</span><span class="w"> </span><span class="mi">1739509942</span><span class="p">,</span><span class="w">
            </span><span class="nl">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RU"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"reputation"</span><span class="p">:</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"regional_internet_registry"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RIPE NCC"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"jarm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29d29d20d29d29d00029d29d29d29decf7fca7fb071cf5a94949fbcc16ef69"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"continent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EU"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"network"</span><span class="p">:</span><span class="w"> </span><span class="s2">"185.7.214.0/24"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"last_analysis_date"</span><span class="p">:</span><span class="w"> </span><span class="mi">1739134408</span><span class="p">,</span><span class="w">
            </span><span class="nl">"total_votes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"harmless"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"malicious"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"whois_date"</span><span class="p">:</span><span class="w"> </span><span class="mi">1736598507</span><span class="w">
        
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>This is a cut of the JSON data that I was able to receive but I cut out a lot of the garbage and useless data from it like http certificates and RSA public keys that take up too much space on this page.</p> <p>-If you want the data from <code class="language-plaintext highlighter-rouge">all</code> of the IP addresses I put it in a zip file along with the IPs in a list and the file version of the script - <a href="/assets/zip/IP-Reputation-script.zip">IP-Reputation-script.zip</a></p> <p>This data contained things like information on the ISP, like contry, company, encryption keys etc.</p> <p>These where the top 10 offenders:</p> <ol> <li>185.7.214.81 <ul> <li>Attempts 28,013</li> <li>Contry Russian Federation (RU)</li> <li>State/City Moskva/Moscow</li> <li>ISP Chang Way Technologies Co. Limited</li> <li>Blacklist/Rep 9/79</li> <li>Tor/Proxy/VPN False</li> <li>Services VPN Server</li> </ul> </li> <li>31.43.185.40 <ul> <li>Attempts 16,330</li> <li>Contry Netherlands</li> <li>State/City Noord-Holland/Amsterdam</li> <li>ISP FOP Dmytro Nedilskyi</li> <li>Blacklist/Rep 2/79</li> <li>Tor/Proxy/VPN False</li> <li>Services Datacenter</li> </ul> </li> <li>87.251.75.145 <ul> <li>Attempts 15,641</li> <li>Contry Netherlands</li> <li>State/City Noord-Holland/Amsterdam</li> <li>ISP Aleksandr Valerevich Mokhonko</li> <li>Blacklist/Rep 9/79</li> <li>Tor/Proxy/VPN False</li> <li>Services Datacenter</li> </ul> </li> <li>31.43.185.39 <ul> <li>Attempts 15,595</li> <li>Contry Netherlands</li> <li>State/City Noord-Holland/Amsterdam</li> <li>ISP FOP Dmytro Nedilskyi</li> <li>Blacklist/Rep 2/79</li> <li>Tor/Proxy/VPN False</li> <li>Services Datacenter</li> </ul> </li> <li>31.43.185.42 <ul> <li>Attempts 11,838</li> <li>Contry Netherlands</li> <li>State/City Noord-Holland/Amsterdam</li> <li>ISP FOP Dmytro Nedilskyi</li> <li>Blacklist/Rep 1/79</li> <li>Tor/Proxy/VPN False</li> <li>Services Datacenter</li> </ul> </li> <li>185.243.96.107 <ul> <li>Attempts 11,691</li> <li>Contry United States (USA)</li> <li>State/City New York/New York City</li> <li>ISP Demenin B.V.</li> <li>Blacklist/Rep 1/79</li> <li>Tor/Proxy/VPN False</li> <li>Services Datacenter</li> </ul> </li> <li>31.43.185.41 <ul> <li>Attempts 10,707</li> <li>Contry Netherlands</li> <li>State/City Noord-Holland/Amsterdam</li> <li>ISP FOP Dmytro Nedilskyi</li> <li>Blacklist/Rep 2/79</li> <li>Tor/Proxy/VPN False</li> <li>Services Datacenter</li> </ul> </li> <li>45.141.84.154 <ul> <li>Attempts 10,672</li> <li>Contry Russian Federation (RU)</li> <li>State/City Sankt-Peterburg/Saint Petersburg</li> <li>ISP Media Land LLC</li> <li>Blacklist/Rep 1/79</li> <li>Tor/Proxy/VPN False</li> <li>Services Datacenter</li> </ul> </li> <li>194.165.17.25 <ul> <li>Attempts 9,386</li> <li>Contry Belgium</li> <li>State/City Brussels Hoofdstedelijk Gewest/Brussels</li> <li>ISP FlyServers S.A.</li> <li>Blacklist/Rep 7/79</li> <li>Tor/Proxy/VPN True (Hosting Provider)</li> <li>Services VPN Server</li> </ul> </li> <li>185.7.214.177 <ul> <li>Attempts 7,149</li> <li>Contry Russian Federation (RU)</li> <li>State/City Moskva/Moscow</li> <li>ISP Chang Way Technologies Co. Limited</li> <li>Blacklist/Rep 7/79</li> <li>Tor/Proxy/VPN False</li> <li>Services VPN Server</li> </ul> </li> </ol> <ul> <li>From the top 10 attackers: <ul> <li>3 where from the Russian Federation</li> <li>5 where from the Netherlands</li> <li>1 was from the United States and</li> <li>1 was from Belgium</li> </ul> </li> </ul> <p>With this new data in json format, I was able to generate a cool-looking <code class="language-plaintext highlighter-rouge">interactive heatmap</code> of what countries all of these IPs belonged to.</p> <p>This heatmap proved to confirm another of my guesses at the start of this project, that it would mostly be <code class="language-plaintext highlighter-rouge">developed countries</code> that are spraying passwords everywhere trying to get lucky.</p> <h2 id="to-see-the-descriptive-text-in-the-embeded-link-you-have-to-highlight-the-text-or-turn-on-light-mode-as-the-color-is-of-the-text-is-black">To see the descriptive text in the embeded link, you have to highlight the text or turn on light mode as the color is of the text is black</h2> <iframe title="Map of IP locations" aria-label="Map" id="datawrapper-chart-dFe5i" src="https://datawrapper.dwcdn.net/dFe5i/1/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="416" data-external="1"> </iframe> <script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r=0;r<e.length;r++)if(e[r].contentWindow===a.source){var i=a.data["datawrapper-height"][t]+"px";e[r].style.height=i}}}))}();
</script> <h1 id="conclution--preventions">Conclution &amp; Preventions</h1> <p>So, we learned that if you have a server exposed to the internet, no matter if you think that you have hidden it, never share its IP address, and don’t tell anyone that it exists, it will still get targeted. So how can we prevent this from happening?</p> <h2 id="cyber-security-frameworks">Cyber Security Frameworks</h2> <ul> <li>Mitre ATT&amp;CK Brute force <ul> <li>On <a href="https://attack.mitre.org" rel="external nofollow noopener" target="_blank">attack.mitre.org</a> there is a page in the <code class="language-plaintext highlighter-rouge">Credential Access</code> section called <code class="language-plaintext highlighter-rouge">Brute Force</code> and explains some useful definitions like <code class="language-plaintext highlighter-rouge">Password Guessing, Password Cracking, Password Spraying, and Credential Stuffing</code>.</li> <li>It explains mitigation techniques like <code class="language-plaintext highlighter-rouge">Multi-Factor Authentication, Password Policies, and User Account Management</code> and how to utilise them to defend your system effectively.</li> <li>It has Detection mechanisms and explains how to collect the necessary data and process it to get valuable information and determine whether or not there are possible brute-forcing or credential exfiltration happening.</li> <li>It contains lots of <code class="language-plaintext highlighter-rouge">references</code> on how it has gathered its information and you can access them to gather more information and strategies on how to mitigate this attack</li> </ul> </li> <li>If you are trying to prevent attacks on a <code class="language-plaintext highlighter-rouge">Web App</code>, then <code class="language-plaintext highlighter-rouge">OWASP</code> could help <a href="https://owasp.org/www-community/attacks/Brute_force_attack" rel="external nofollow noopener" target="_blank">owasp.org</a> <ul> <li>OWASP gives an in-depth guide to regular users on the description and risk of how brute forcing can affect a company and a guide to penetration testers on how to find and exploit this.</li> </ul> </li> <li>The <code class="language-plaintext highlighter-rouge">Essential Eight</code> by the <code class="language-plaintext highlighter-rouge">Australian Cyber Security Centre</code> (ACSC) <a href="https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/essential-eight/essential-eight-explained" rel="external nofollow noopener" target="_blank">essential eight</a> <ul> <li>Multifactor Authentication</li> <li>Restrict administrative privilege</li> </ul> </li> </ul> <p>With multifactor Authentication even if someone can get a user password they are not able to get into the account because they have to complete another challenge like entering a 6-digit OTP code or E-Mail verification.</p> <p>Restricting Administrative privileges can also help a company, if a user that gets breached doesn’t have MFA then it will be the account policies assigned to that user that will stump the attacker, with minimal privileges then an attacker isn’t able to access critical applications or data reducing the risk.</p> <p>If every company in Australia has not already, they should start adopting this framework as it is becoming the new Australian standard.</p> <h2 id="preventions">Preventions</h2> <p>If we take a look at the Mitre ATT&amp;CK and the Essential Eight documents on brute force attacks, then can determine that 2 things can stop attackers extremely effectively.</p> <ol> <li>MFA</li> <li>Access Controls</li> </ol> <p>MFA or Multi-factor Authentication will stop almost all attacks regarding straight brute forcing and guessing credentials. Even if someone gets a user username and password they have to go through another layer of security that is often extremely hard to get through.</p> <p>Having good Access Controls not only for the user but for the devices is also good practice, if you have a machine with an RDP port open to the internet, then maybe restrict what IP addresses can access that port by having <code class="language-plaintext highlighter-rouge">whitelists</code>. Having <code class="language-plaintext highlighter-rouge">blocklists for IP addresses that are known to be malicious</code> can also improve security and access controls can also help a company if a user does manage to get breached by limiting what they can even access in the first place.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 ./Alexander . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: March 02, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>